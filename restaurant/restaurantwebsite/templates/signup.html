<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>
  
  
  
  
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/jquery.validation/1.16.0/jquery.validate.min.js"></script>
    
    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.3/jquery.validate.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.3/localization/messages_es.min.js"></script>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/validator/13.7.2/validator.min.js" integrity="sha512-TfJ6Uk3qNC3aEwuf0SxgM5SKnGr+qohZJ7V/9rxBUpzR5H5QjNk7Bfk5gNzoie8+rkjhr90PZGgX9QJ+NYtVzQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

  
  
    <title>registro</title>
</head>
<body >
  
  <style>


body{


  background: url("{% static '/images/pizza7.jpg' %}") ;
  background-repeat: no-repeat;
 

}
.container{
    max-width: 700px;
    width: 150%;
    background-color: #fff;
    padding: 25px 30px;
    border-radius: 10px;
    box-shadow: 0 5px 10px rgba(0,0,0,0.15)
  
}
.container .title{
  font-size: 25px;
  font-weight: 500;
  position: relative;
  
}
.container .title::before{
  content: "";
  position: absolute;
  left: 0;
  bottom: 0;
  height: 3px;
  width: 30px;
  border-radius: 5px;
  background: linear-gradient(135deg, #71b7e6, #9b59b6);
}
.content form .user-details{
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  margin: 20px 0 12px 0;
}
form .user-details .input-box{
  margin-bottom: 15px;
  width: calc(100% / 2 - 20px);
  
}
form .input-box span.details{
  display: block;
  font-weight: 500;
  margin-bottom: 5px;
}
.user-details .input-box input{
  height: 45px;
  width: 100%;
  outline: none;
  font-size: 16px;
  border-radius: 5px;
  padding-left: 15px;
  border: 1px solid #ccc;
  border-bottom-width: 2px;
  transition: all 0.3s ease;
}
.user-details .input-box input:focus,
.user-details .input-box input:valid{
  border-color: #9b59b6;
}
 form .gender-details .gender-title{
  font-size: 20px;
  font-weight: 500;
 }
 form .category{
   display: flex;
   width: 80%;
   margin: 14px 0 ;
   justify-content: space-between;
 }
 form .category label{
   display: flex;
   align-items: center;
   cursor: pointer;
 }
 form .category label .dot{
  height: 18px;
  width: 18px;
  border-radius: 50%;
  margin-right: 10px;
  background: #d9d9d9;
  border: 5px solid transparent;
  transition: all 0.3s ease;
}
 #dot-1:checked ~ .category label .one,
 #dot-2:checked ~ .category label .two,
 #dot-3:checked ~ .category label .three{
   background: #9b59b6;
   border-color: #d9d9d9;
 }
 form input[type="radio"]{
   display: none;
 }
 form .button{
   height: 45px;
   margin: 35px 0
 }
 form .button input{
   height: 100%;
   width: 100%;
   border-radius: 5px;
   border: none;
   color: #fff;
   font-size: 18px;
   font-weight: 500;
   letter-spacing: 1px;
   cursor: pointer;
   transition: all 0.3s ease;
   background: linear-gradient(135deg, #71b7e6, #9b59b6);
 }
 form .button input:hover{
  /* transform: scale(0.99); */
  background: linear-gradient(-135deg, #71b7e6, #9b59b6);
  }
 @media(max-width: 584px){
 .container{
  max-width: 100%;
}
form .user-details .input-box{
    margin-bottom: 15px;
    width: 100%;
  }
  form .category{
    width: 100%;
  }
  .content form .user-details{
    max-height: 300px;
    overflow-y: scroll;
  }
  .user-details::-webkit-scrollbar{
    width: 5px;
  }
  }
  @media(max-width: 459px){
  .container .content .category{
    flex-direction: column;
  }

}


  </style>

  {% include 'Navbar.html' %}


  <br>
  {% if messages %}
  <div class="alert alert-danger position-relative" style="font-size: 1.5em;">
    <ul class="list-unstyled mb-0">
      {% for message in messages %}
      <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>
        {{ message }}
      </li>
      {% endfor %}
    </ul>
    <script>
      setTimeout(function() {
        document.querySelector('.alert').classList.add('fade');
        setTimeout(function() {
          document.querySelector('.alert').style.display = 'none';
        }, 3500); 
      }, 4000); 
    </script>
  </div>
  {% endif %}



  <div class="container">


  


    <div class="title">Registrarse</div>
    <div class="content">
      <form id="myform"  method="POST">
        {% csrf_token %}
        <div class="user-details">
          <div class="input-box">
            <span class="details">Nombre</span>
            <input class="noSpace noRepetidos lettersonly" id="nombre" value="{{ nombre }}" name="nombre" title="Ejemplo: Pedro,Ana,Noe SIN CARACTERES REPETIDOS" pattern="^(?!.*(.).*\1)[a-zA-Z]+$" maxlength="20" minlength="3" type="text" placeholder="Escribe tu Nombre" required>
          </div>
          <div class="input-box">
            <span class="details">Apellido</span>
            <input id="apellido" class="noSpace noRepetidos apellidocontrol" value="{{ apellido }}" name="apellido"  pattern="^(?!.*(.).*\1)[a-zA-Z]+$" title="Ejemplo: Josue,Funez,Castro" maxlength="20" minlength="5" type="text" placeholder="Escribe tu Apellido" required>
          </div>
          <div class="input-box">
            <span class="details">Correo Electronico</span>
            <input id="email" class="noSpace" value="{{ email }}" name="email" pattern="[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}" title="Por favor introduce un email válido Ejemplo:usuario@gmail.com" type="email" placeholder="Escribe tu Correo Electronico" required>
          </div>
          <div class="input-box">
            <span class="details">Nombre de Usuario</span>
            <input id="username" class="noSpace noRepetidos usernamecontrol" value="{{ username }}" name="username" title="Ejemplo:usuario21,ethan12,nier2 pero sin caracteres repetidos ni espacios" maxlength="16" minlength="4" pattern="^(?!.*(.).*\1)[a-zA-Z0-9]+$" type="text" placeholder="Escribe tu Nombre de usuario" required>
          </div>

          <div class="input-box">
            <span class="details">Contraseña</span>
            <input id="password" maxlength="16" minlength="8" name="password" type="password" placeholder="Escribe tu Contraseña" required>
            
            <p id="password-strength"></p>
            <p>"La contraseña debe tener al menos 8 caracteres, incluyendo una letra mayúscula, una letra minúscula",</p>

          </div>
          <div class="input-box">
            <span class="details">Confirma tu Contraseña</span>
            <input id="confirm_password" name="confirm_password" type="password" placeholder="Confirma tu Contraseña" required>
          </div>



          <div class="input-box">
            <span class="details">Numero de telefono</span>
            <input id="telefono" value="{{ telefono }}" class="telefono telefonoHonduras"  type="number" placeholder="Escribe tu Numero de Telefono" name="telefono" required>
            

            <p style="font-style: italic;" id="telefonoError" class="error-message"></p>

          </div>


        </div>

        
        {% if registro_exitoso %}
        <div class="alert alert-success">
            El registro se realizó correctamente.
        </div>
        {% endif %}


        <div class="button">
          <input type="submit" value="Registrarse">
        </div>
      </form>
    </div>
  </div>

<br>
  






<script>
  $(document).ready(function() {
    $.validator.setDefaults({
      lang: 'es'
    });
  
  
    $(document).ready(function() {
    $("#myForm").submit(function(event) {
      event.preventDefault(); // Evita el envío del formulario
      // Validaciones
      var name = $("input[name='name']").val();
      var email = $("input[name='email']").val();
      var password = $("input[name='password']").val();
      var apellido = $("input[name='apellido']").val();
      var id_usuario=  $("input[name='id_usuario']").val();
      var username=  $("input[name='username']").val();
      if (name === "") {
        alert("Por favor, ingrese su nombre.");
        return false;
      }
      if (email === "") {
        alert("Por favor, ingrese su correo electrónico.");
        return false;
      }
      if (password === "") {
        alert("Por favor, ingrese su contraseña.");
        return false;
      }
  
      if (apellido === "") {
        alert("Por favor, ingrese su apellido");
        return false;
      }
      if (username === "") {
        alert("Por favor, ingrese su Nombre de Usuario");
        return false;
      }
      if (id_usuario === "") {
        alert("Por favor, ingrese su id.");
        return false;
      }
  
      // Si todo está bien, se puede enviar el formulario
      alert("Formulario enviado correctamente.");
      $(this).unbind('submit').submit(); // Envía el formulario
    });
  });
  
  
  
    
    $('#password').keyup(function() {
      var password = $(this).val();
      var strength = 0;
  
      // Validar la longitud de la contraseña
      if (password.length < 8) {
        $('#password-strength').removeClass().addClass('weak').text('Débil');
        return;
      }
  
      // Validar la presencia de caracteres especiales
      if (password.match(/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/)) {
        strength += 1;
      }
  
      // Validar la presencia de letras minúsculas y mayúsculas
      if (password.match(/[a-z]/) && password.match(/[A-Z]/)) {
        strength += 1;
      }
  
      // Validar la presencia de números
      if (password.match(/\d+/)) {
        strength += 1;
      }
  
      // Validar la fortaleza de la contraseña
      if (strength == 0) {
        $('#password-strength').removeClass().addClass('weak').text('Débil');
      } else if (strength == 1) {
        $('#password-strength').removeClass().addClass('medium').text('Media');
      } else {
        $('#password-strength').removeClass().addClass('strong').text('Fuerte');
      }
    });
  
    $.extend($.validator.messages, {
      required: "Por favor completa este campo"
    });
  
    $("#myform").validate({
      rules: {
        nombre: {
          noRepetidos:true,
          required: true, 
          minlength: 3,
          maxlength:18,
          lettersonly: true,
          noSpace:true,
        },
        apellido: {
          noRepetidos:true,
          noSpace:true,
          required: true,
          apellidocontrol: true,
          minlength: 5,
          maxlength: 20
        },
        username: {
          noRepetidos:true,
          noSpace:true,
          required: true,
          usernamecontrol: true,
          minlength: 4,
          maxlength: 16
        },
        email: {
          noRepetidos:true,
          noSpace:true,
          required: true,
          emailcontrol: true,
        },
        password: {
          
          required: true,
          minlength: 8,
          maxlength: 16
        },


        telefono: {
          telefonoHonduras:true,
          required: true,
          minlength: 8,
          maxlength: 8
        },

        confirm_password: {
          
          required: true,
          minlength: 8,
          maxlength: 16
        }



      },


      
      messages: {
        nombre: {
          required:"Debes ingresar tu Nombre",
          noRepetidos:"No Se permiten Letras Repetidas",

          minlength: "Debes ingresar como mínimo 3 letras.",
          maxlength:"El Maximo de Letras de un nombre no debe ser mayor a 18",
          noSpace:"No se Permiten Espacios Aca",
        },
        apellido: {
          required:"Debes Ingresar Tu apellido",
          noRepetidos:"No Se permiten Letras Repetidas",

          minlength: "Debes ingresar como mínimo 5 letras.",
          maxlength: "No puedes ingresar más de 20 letras.",
          noSpace:"No se Permiten Espacios Aca NO HAGA ESO",
        },
        username: {
          required:"Debes ingresar tu Nombre de Usuario",
          noRepetidos:"No Se permiten Letras Repetidas",
          usernamecontrol: "Introduce un Nombre de Usuario Valido Sin espacios ni Letras Repetidas Ejemplo: Minombre12",
          minlength: "Debes ingresar como mínimo 4 caracteres.",
          maxlength: "No puedes ingresar más de 16 caracteres.",
          noSpace:"No se Permiten Espacios Aca Ya se lo Dije",
        },
        email: {
          required:"Debes introducir Tu Correo Electronico",
          noRepetidos:"No Se permiten Letras Repetidas",
          emailcontrol: "Por favor introduce un email válido Ejemplo: usuario@gmail.com sin espacios",
          noSpace:"No se Permiten Espacios Aca YA Pare",
        },
        password: {
          required:"Debes introducir tu Contraseña",
          minlength: "Debes ingresar como mínimo 8 caracteres.",
          maxlength: "No puedes ingresar más de 16 caracteres."



        },



        confirm_password: {
          required:"Debes introducir tu Contraseña Nuevamente",
          minlength: "Debes ingresar como mínimo 8 caracteres.",
          maxlength: "No puedes ingresar más de 16 caracteres."
        },
      

        telefono: {
          telefonoHonduras:"Por favor ingresa un número de teléfono válido de Honduras (ej: +504 8888-8888)",
          required:"Debes introducir tu Numero de Telefono",
          minlength: "Debes ingresar como mínimo 8 caracteres.",
          maxlength: "No puedes ingresar más de 8 caracteres."
        },

      },



      submitHandler: function(form) {

        
        var telefono = $("#telefono").val();
var telefonoPattern = /^(504)?[ -]?(?:(\d)(?!\2{7})){8}$/;
if (!telefonoPattern.test(telefono)) {
  $("#telefonoError").text("El número de teléfono debe tener el formato ####-#### y no puede tener todos los dígitos iguales");
  return false;
}



        $("#mensaje-confirmacion").show();
        form.submit();
      }
    });
  
  // Regla personalizada para validar Que no hayan Espacios
    $.validator.addMethod("noSpace", function(value, element) {
    return value.trim().length !== 0; // Devuelve verdadero si no hay espacios en blanco alrededor de la entrada
  }, "No se permiten espacios en blanco");
  

  
$.validator.addMethod("telefonoHonduras", function(value, element) {
  return this.optional(element) || /^(\+504)?[ -]?\d{4}[ -]?\d{4}$/.test(value);
}, "Por favor ingresa un número de teléfono válido de Honduras (ej: +504 8888-8888)");


  
$.validator.addMethod("lettersonly", function(value, element) {
    var regex = /^[A-Z][a-z]{2,}\s[A-Z][a-z]{3,}$/;
    var isValid = regex.test(value);
    if (!isValid) {
        $.validator.messages.lettersonly = "Este campo solo puede contener letras y debe comenzar con una letra mayúscula";
        if (value.trim().split(" ").length < 2) {
            $.validator.messages.lettersonly = "Debe introducir su Segundo Nombre después del espacio";
        } else if (!/^[A-Z][a-z]{2,}\s[A-Z][a-z]{3,}$/.test(value)) {
            $.validator.messages.lettersonly = "El Nombre y su Segundo Nombre debe comenzar con una letra mayúscula y tener al menos 3 o 4 letras";
        }
        return false;
    }
    return true;
}, "");



$.validator.addMethod("apellidocontrol", function(value, element) {
    var regex = /^[A-Z][a-z]{2,}\s[A-Z][a-z]{3,}$/;
    var isValid = regex.test(value);
    if (!isValid) {
        $.validator.messages.apellidocontrol = "Este campo solo puede contener letras y debe comenzar con una letra mayúscula";
        if (value.trim().split(" ").length < 2) {
            $.validator.messages.apellidocontrol = "Debe introducir su segundo Apellido después del espacio";
        } else if (!/^[A-Z][a-z]{2,}\s[A-Z][a-z]{3,}$/.test(value)) {
            $.validator.messages.apellidocontrol = "El Apellido y su Segundo Apellido debe comenzar con una letra mayúscula y tener al menos 3 o 4 letras";
        }
        return false;
    }
    return true;
}, "");
 

  $.validator.addMethod("usernamecontrol", function(value, element) {
  return this.optional(element) || /^(?!.*(.).*\1)[a-zA-Z]+[0-9]*$/.test(value);
}, "Introduce un Nombre de Usuario Valido Sin espacios ni Letras Repetidas Ejemplo: Minombre12 y No se permiten letras repetidas pero consecutivas");

  // Regla personalizada para validar EL Correo Electronico
  $.validator.addMethod("emailcontrol", function(value, element) {
  // Nueva validación de la regla de correo electrónico
  return this.optional(element) || /^[^\s@]+@[^\s@]+\.[^\s@]{2,}(?:\.[^\s@]{2,})?$/.test(value);
}, "Por favor introduce un email válido Ejemplo: usuario@gmail.com sin espacios");
  
  

  $.validator.addMethod("usernamecontrol", function(value, element) {
  // Validación de la nueva regla
  return this.optional(element) || /^[A-Z][a-zA-Z0-9]*$/i.test(value);
}, "Introduce un Nombre de Usuario Valido Sin espacios ni Letras Repetidas Ejemplo: Minombre12");

  });
  //regla para validar Los caracteres repetidos
  $.validator.addMethod("noRepetidos", function(value, element) {
    return this.optional(element) || !/(.)\1+/.test(value);
  }, "No se permiten caracteres repetidos en este campo");
  
    </script>
  
     




</body>
</html>