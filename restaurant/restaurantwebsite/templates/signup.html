<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>
  
  
  
  
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/jquery.validation/1.16.0/jquery.validate.min.js"></script>
    
    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.3/jquery.validate.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.3/localization/messages_es.min.js"></script>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/validator/13.7.2/validator.min.js" integrity="sha512-TfJ6Uk3qNC3aEwuf0SxgM5SKnGr+qohZJ7V/9rxBUpzR5H5QjNk7Bfk5gNzoie8+rkjhr90PZGgX9QJ+NYtVzQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

  
    <link rel="stylesheet" href="{% static 'css/signup.css' %}">
    <title>registro</title>
</head>
<body >
  
  
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark" id="nav">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">Pizza Wave</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="/usuario">Inicio</a>
          </li>
  
         
          {% if request.user.is_authenticated %}
           
          <li class="nav-item">
            <a class="nav-link" href="/logout">Cerrar Sesion</a>
          </li>
         

          <li class="nav-item">
            <a class="nav-link" href="/pedidos">Realizar Pedidos</a>
          </li>
 
 
          {% else %}
          
          <li class="nav-item">
            <a class="nav-link" href="/login_user">Iniciar Sesion</a>
          </li>
           

                   <li class="nav-item">
            <a class="nav-link" href="/signup">Registrarse</a>
          </li>




          {% endif %}

         
          <li class="nav-item">
            <a class="nav-link" href="/menu">Menu</a>
          </li>

         


        </ul>
      </div>
    </div>
  </nav>




  <div class="container">


    
  {% if messages %}
  <ul class="messages">
    {% for message in messages %}
    <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}
      <script>
      setTimeout(function() {
        $('.messages').fadeOut('slow');
      }, 2000);
      </script>
    </li>
    {% endfor %}
  </ul>
  {% endif %}


    <div class="title">Registrarse</div>
    <div class="content">
      <form id="myform"  method="POST">
        {% csrf_token %}
        <div class="user-details">
          <div class="input-box">
            <span class="details">Nombre</span>
            <input class="noSpace noRepetidos lettersonly" id="nombre" value="{{ nombre }}" name="nombre" title="Ejemplo: Pedro,Ana,Noe SIN CARACTERES REPETIDOS" pattern="^(?!.*(.).*\1)[a-zA-Z]+$" maxlength="20" minlength="3" type="text" placeholder="Escribe tu Nombre" required>
          </div>
          <div class="input-box">
            <span class="details">Apellido</span>
            <input id="apellido" class="noSpace noRepetidos lettersonly" value="{{ apellido }}" name="apellido"  pattern="^(?!.*(.).*\1)[a-zA-Z]+$" title="Ejemplo: Josue,Funez,Castro" maxlength="20" minlength="5" type="text" placeholder="Escribe tu Apellido" required>
          </div>
          <div class="input-box">
            <span class="details">Correo Electronico</span>
            <input id="email" class="noSpace" value="{{ email }}" name="email" pattern="[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}" title="Por favor introduce un email válido Ejemplo:usuario@gmail.com" type="email" placeholder="Escribe tu Correo Electronico" required>
          </div>
          <div class="input-box">
            <span class="details">Nombre de Usuario</span>
            <input id="username" class="noSpace noRepetidos " value="{{ username }}" name="username" title="Ejemplo:usuario21,ethan12,nier2 pero sin caracteres repetidos ni espacios" maxlength="16" minlength="4" pattern="^(?!.*(.).*\1)[a-zA-Z0-9]+$" type="text" placeholder="Escribe tu Nombre de usuario" required>
          </div>
          <div class="input-box">
            <span class="details">Numero de telefono</span>
            <input id="telefono"  type="text" placeholder="Escribe tu Numero de Telefono" required>
          </div>
          <div class="input-box">
            <span class="details">Contraseña</span>
            <input id="password" maxlength="16" minlength="8" name="password" type="password" placeholder="Escribe tu Contraseña" required>
            
            <p id="password-strength"></p>
            <p>"La contraseña debe tener al menos 8 caracteres, incluyendo una letra mayúscula, una letra minúscula",</p>

          </div>
          <div class="input-box">
            <span class="details">Confirma tu Contraseña</span>
            <input name="confirm_password" type="password" placeholder="Confirma tu Contraseña" required>
          </div>
        </div>

        
        {% if registro_exitoso %}
        <div class="alert alert-success">
            El registro se realizó correctamente.
        </div>
        {% endif %}


        <div class="button">
          <input type="submit" value="Registrarse">
        </div>
      </form>
    </div>
  </div>

<br>
  






<script>
  $(document).ready(function() {
    $.validator.setDefaults({
      lang: 'es'
    });
  
  
    $(document).ready(function() {
    $("#myForm").submit(function(event) {
      event.preventDefault(); // Evita el envío del formulario
      // Validaciones
      var name = $("input[name='name']").val();
      var email = $("input[name='email']").val();
      var password = $("input[name='password']").val();
      var apellido = $("input[name='apellido']").val();
      var id_usuario=  $("input[name='id_usuario']").val();
      var username=  $("input[name='username']").val();
      if (name === "") {
        alert("Por favor, ingrese su nombre.");
        return false;
      }
      if (email === "") {
        alert("Por favor, ingrese su correo electrónico.");
        return false;
      }
      if (password === "") {
        alert("Por favor, ingrese su contraseña.");
        return false;
      }
  
      if (apellido === "") {
        alert("Por favor, ingrese su apellido");
        return false;
      }
      if (username === "") {
        alert("Por favor, ingrese su Nombre de Usuario");
        return false;
      }
      if (id_usuario === "") {
        alert("Por favor, ingrese su id.");
        return false;
      }
  
      // Si todo está bien, se puede enviar el formulario
      alert("Formulario enviado correctamente.");
      $(this).unbind('submit').submit(); // Envía el formulario
    });
  });
  
  
  
    
    $('#password').keyup(function() {
      var password = $(this).val();
      var strength = 0;
  
      // Validar la longitud de la contraseña
      if (password.length < 8) {
        $('#password-strength').removeClass().addClass('weak').text('Débil');
        return;
      }
  
      // Validar la presencia de caracteres especiales
      if (password.match(/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/)) {
        strength += 1;
      }
  
      // Validar la presencia de letras minúsculas y mayúsculas
      if (password.match(/[a-z]/) && password.match(/[A-Z]/)) {
        strength += 1;
      }
  
      // Validar la presencia de números
      if (password.match(/\d+/)) {
        strength += 1;
      }
  
      // Validar la fortaleza de la contraseña
      if (strength == 0) {
        $('#password-strength').removeClass().addClass('weak').text('Débil');
      } else if (strength == 1) {
        $('#password-strength').removeClass().addClass('medium').text('Media');
      } else {
        $('#password-strength').removeClass().addClass('strong').text('Fuerte');
      }
    });
  
    $.extend($.validator.messages, {
      required: "Por favor completa este campo"
    });
  
    $("#myform").validate({
      rules: {
        id_usuario: {
          required: true
        },
        nombre: {
          noRepetidos:true,
          required: true, 
          minlength: 3,
          maxlength:18,
          lettersonly: true,
          noSpace:true,
        },
        apellido: {
          noRepetidos:true,
          noSpace:true,
          required: true,
          lettersonly: true,
          minlength: 5,
          maxlength: 20
        },
        username: {
          noRepetidos:true,
          noSpace:true,
          required: true,
          usernamecontrol: true,
          minlength: 4,
          maxlength: 16
        },
        email: {
          noRepetidos:true,
          noSpace:true,
          required: true,
          emailcontrol: true,
        },
        password: {
          
          required: true,
          minlength: 8,
          maxlength: 16
        }
      },
      messages: {
        nombre: {
          required:"Debes ingresar tu Nombre",
          noRepetidos:"No Se permiten Letras Repetidas",
          lettersonly: "Este campo solo puede contener letras y debe comenzar con una letra mayúscula sin espacios.",
          minlength: "Debes ingresar como mínimo 3 letras.",
          maxlength:"El Maximo de Letras de un nombre no debe ser mayor a 18",
          noSpace:"No se Permiten Espacios Aca",
        },
        apellido: {
          required:"Debes Ingresar Tu apellido",
          noRepetidos:"No Se permiten Letras Repetidas",
          lettersonly: "Este campo solo puede contener letras y debe comenzar con una letra mayúscula sin espacios.",
          minlength: "Debes ingresar como mínimo 5 letras.",
          maxlength: "No puedes ingresar más de 20 letras.",
          noSpace:"No se Permiten Espacios Aca NO HAGA ESO",
        },
        username: {
          required:"Debes ingresar tu Nombre de Usuario",
          noRepetidos:"No Se permiten Letras Repetidas",
          usernamecontrol: "Introduce un Nombre de Usuario Valido Sin espacios ni Letras Repetidas Ejemplo: Minombre12",
          minlength: "Debes ingresar como mínimo 4 caracteres.",
          maxlength: "No puedes ingresar más de 16 caracteres.",
          noSpace:"No se Permiten Espacios Aca Ya se lo Dije",
        },
        email: {
          required:"Debes introducir Tu Correo Electronico",
          noRepetidos:"No Se permiten Letras Repetidas",
          emailcontrol: "Por favor introduce un email válido Ejemplo: usuario@gmail.com sin espacios",
          noSpace:"No se Permiten Espacios Aca YA Pare",
        },
        password: {
          required:"Debes introducir tu Contraseña",
          minlength: "Debes ingresar como mínimo 8 caracteres.",
          maxlength: "No puedes ingresar más de 16 caracteres."
        }
      },
      submitHandler: function(form) {
        $("#mensaje-confirmacion").show();
        form.submit();
      }
    });
  
  // Regla personalizada para validar Que no hayan Espacios
    $.validator.addMethod("noSpace", function(value, element) {
    return value.trim().length !== 0; // Devuelve verdadero si no hay espacios en blanco alrededor de la entrada
  }, "No se permiten espacios en blanco");
  
  // Regla personalizada para validar solo letras
  $.validator.addMethod("lettersonly", function(value, element) {
    return this.optional(element) || /^[A-Z](?!.*(.).*\1)[A-Za-z0-9]+$/i.test(value);
  }, "Este campo solo puede contener letras y debe comenzar con una letra mayúscula sin espacios.");
  
  // Regla personalizada para validar EL Correo Electronico
  $.validator.addMethod("emailcontrol", function(value, element) {
    // Nueva validación de la regla de correo electrónico
    return this.optional(element) || /^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/i.test(value);
  }, "Por favor introduce un email válido Ejemplo: usuario@gmail.com sin espacios");
  
  
  $.validator.addMethod("usernamecontrol", function(value, element) {
  // Validación de la nueva regla
  return this.optional(element) || /^[A-Z][a-zA-Z0-9]*$/i.test(value);
}, "Introduce un Nombre de Usuario Valido Sin espacios ni Letras Repetidas Ejemplo: Minombre12");

  });
  //regla para validar Los caracteres repetidos
  $.validator.addMethod("noRepetidos", function(value, element) {
    return this.optional(element) || !/(.)\1+/.test(value);
  }, "No se permiten caracteres repetidos en este campo");
  
    </script>
  
     




</body>
</html>