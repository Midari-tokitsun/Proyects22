<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto|Varela+Round">
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>




<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/jquery.validation/1.16.0/jquery.validate.min.js"></script>



<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.3/jquery.validate.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.3/localization/messages_es.min.js"></script>

<script src="//cdn.datatables.net/1.11.3/js/jquery.dataTables.min.js"></script>
<link rel="stylesheet" href="//cdn.datatables.net/1.11.3/css/jquery.dataTables.min.css">



<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.3/jquery.validate.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.3/localization/messages_es.min.js"></script>


    <title>Provedores</title>
</head>
<body>

	<style>

		body{
		  background: url("{% static 'images/pizzab14.jpg' %}") center no-repeat;
		background-size: cover;
	
		}
	
	  </style>

<nav class="navbar navbar-expand-lg navbar-dark bg-dark" id="navbar">
  <div class="container-fluid">
    <a class="navbar-brand" href="#">Pizza Wave</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
    <ul class="navbar-nav">
    <li class="nav-item">
    <a class="nav-link active" aria-current="page" href="/usuario">Inicio</a>
    </li>
  
  
    {% if request.session.username %}
  
    <div class="collapse navbar-collapse" id="navbarNavDarkDropdown">
    <ul class="navbar-nav">
      <li class="nav-item dropdown">
    
    <a class="nav-link dropdown-toggle" href="#" id="navbarDarkDropdownMenuLink" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vista Empleados
    </a>
    <ul class="dropdown-menu dropdown-menu-dark" aria-labelledby="navbarDarkDropdownMenuLink">
    <li class="nav-item">
      <a class="nav-link" href="/cargoregister">Registros de Cargos del Empleado</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-link" href="/empleado">Registro de Empleados</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-link" href="/tipodocumentoemp">Registro de Tipo De Documento</a>
    </li>


    <li class="nav-item">
      <a class="nav-link" href="/departamentohome">Registro de Departamento</a>
    </li>

    <li class="nav-item">
      <a class="nav-link" href="/puestos">Control de Puestos</a>
    </li>

    <li class="nav-item">
      <a class="nav-link" href="/sucursal">Control de sucursal</a>
    </li>

    </ul>
  
    </li>
    </ul>
  </div>
    
  
  
    <div class="collapse navbar-collapse" id="navbarNavDarkDropdown">
    <ul class="navbar-nav">
      <li class="nav-item dropdown">
      <a class="nav-link dropdown-toggle" href="#" id="navbarDarkDropdownMenuLink" role="button" data-bs-toggle="dropdown" aria-expanded="false">
      Vista Usuarios
      </a>
      <ul class="dropdown-menu dropdown-menu-dark" aria-labelledby="navbarDarkDropdownMenuLink">
    
          <li class="nav-item">
              <a class="nav-link" href="/registrousuarios">Usuarios</a>
            </li>
    
            


      <li class="nav-item">
      <a class="nav-link" href="/pedidos">Pedidos</a>
      </li>


      <li class="nav-item">
          <a class="nav-link" href="/facturacion">Factura</a>
        </li>
      


        <li class="nav-item">
          <a class="nav-link" href="/impuesto">Impuestos</a>
        </li>


      <li class="nav-item">
        <a class="nav-link" href="/estadopedido">Estado Pedido</a>
        </li>
  


          <li class="nav-item">
            <a class="nav-link" href="/reservaciones">Registros de Reservaciones</a>
            </li>



          <li class="nav-item">
            <a class="nav-link" href="/promociones">Registros de Promociones</a>
            </li>

            



          <li class="nav-item">
            <a class="nav-link" href="/metodopago">Metodo de Pago</a>
            </li>



            <li class="nav-item">
              <a class="nav-link" href="/sartabla">SAR</a>
              </li>

    
      </ul>
      </li>
    </ul>
    </div>



    <div class="collapse navbar-collapse" id="navbarNavDarkDropdown">
      <ul class="navbar-nav">
      <li class="nav-item dropdown">
      <a class="nav-link dropdown-toggle" href="#" id="navbarDarkDropdownMenuLink" role="button" data-bs-toggle="dropdown" aria-expanded="false">
        Vista productos
      </a>
      <ul class="dropdown-menu dropdown-menu-dark" aria-labelledby="navbarDarkDropdownMenuLink">
    
        <li class="nav-item">
        <a class="nav-link" href="/categoria">Registros de categoria</a>
        </li>
    
        <li class="nav-item">
        <a class="nav-link" href="/almacen">Registros del almacen </a>
        </li>

        <li class="nav-item">
        <a class="nav-link" href="/familiaproducto">Registros de familia producto</a>
        </li>

        <li class="nav-item">
        <a class="nav-link" href="/menutabla">Registros del Menu</a>
        </li>


        <li class="nav-item">
          <a class="nav-link" href="/historicomenutabla">Registros Historicos del Menu</a>
          </li>

        <li class="nav-item">
        <a class="nav-link" href="/elaboracion">Registros de Elaboracion</a>
        </li>


        <li class="nav-item">
        <a class="nav-link" href="/recetatablaregistros">Registros de Receta</a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="/inventario">Registros de inventario</a>
          </li>

        <li class="nav-item">
          <a class="nav-link" href="/productos">Registros de Productos</a>
          </li>

          <li class="nav-item">
              <a class="nav-link" href="/historicoproducto">Registros Historicos de Productos</a>
              </li>

          
          <li class="nav-item">
              <a class="nav-link" href="/provedores">Registros de Proveedores</a>
              </li>
    

    
      </ul>
      </li>
      </ul>
      </div>
    
  
  
  
  
    <li class="nav-item">
    <a class="nav-link" href="/signout">Cerrar Sesion</a>
    </li>
  
  
  
   
    {% else %}
    
    <li class="nav-item">
    <a class="nav-link" href="/login_user">Iniciar Sesion</a>
    </li>
     
  
       <li class="nav-item">
    <a class="nav-link" href="/signup">Registrarse</a>
    </li>
  
  
    
    {% endif %}
    
    
  
  
  
    
  
       <li class="nav-item">
    <a class="nav-link" href="/menu">Menu</a>
    </li>
  
    
  
    <div class="collapse navbar-collapse" id="navbarNav">
    <li class="nav-item">
      <a class="nav-link desactivated">{{request.session.username}}</a>
    </li>
    </div>
  
  
    </ul>
    </div>
  </div>
  </nav>

    <br>
    <h1>Provedores Control</h1>

    <table id="mytable" class="table table-dark table-hover" >
        <thead>
            <tr>
                <th>
                    <span class="custom-checkbox">
                        <input type="checkbox" id="selectAll">
                        <label for="selectAll"></label>
                    </span>
                </th>
                <th>ID</th>
                <th>Nombre</th>
                <th>Apellido</th>
                <th>Compañia</th>
                <th>Telefono</th>
                <th>Email</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody>
           {% for p in prov %} 
            <tr>
                <td>
                    <span class="custom-checkbox">
                        <input type="checkbox" id="checkbox1" name="options[]" value="1">
                        <label for="checkbox1"></label>
                    </span>
                </td>
                <td>{{p.id_provedor}}</td>
                <td>{{p.nombre_provedor}}</td>
                <td>{{p.apellido_provedor}}</td>
                <td>{{p.compañia_provevdor}}</td>
                <td>{{p.telefono_provedor}}</td>
                <td>{{p.email_provedor}}</td>
                <td>
                    <!-- Button trigger modal -->
            <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#editproModal-{{forloop.counter}}">
                <i class="material-icons" data-toggle="tooltip" title="Edit">&#xE254;</i>
                    </button>

                    <a href="/eliminarprovedor/{{p.id_provedor}}" class="delete" data-toggle="modal"><i class="material-icons" data-toggle="tooltip" title="Delete">&#xE872;</i></a>
                </td>
            </tr>
            {% endfor %} 
        </tbody>
    </table>
    </div>
</div>
</div>

    


<!-- Button trigger modal -->
<button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#AgregarProvedor">
    Agregar Provedor
  </button>
  
  <!-- Modal -->
  <div class="modal fade" id="AgregarProvedor" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Agregar Provedor</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
            <form id="myform" action="{% url 'agregarprovedor' %}" method="POST">
                {% csrf_token %}
                <label for="">ID</label>
                <input minlength="0" maxlength="10" class="form-control" type="text" name="id_provedor" id="id_provedor">
                <br>
                <label for="">Nombre</label>
                <input minlength="0" maxlength="20" class="form-control" type="text" name="nombre_provedor" id="nombre_provedor">
                <br>
                <label for="">Apellido</label>
                <input minlength="0" maxlength="20" class="form-control" type="text" name="apellido_provedor" id="apellido_provedor">
                <br>
                <label for="">Compañia</label>
                <input minlength="0" maxlength="15" class="form-control" type="text" name="compañia_provevdor" id="compañia_provevdor">
                <br>
                <label for="">Telefono</label>
                <input class="form-control" type="text" name="telefono_provedor" id="telefono_provedor" minlength="8" maxlength="8">
                <p style="background-color: red;" id="telefonoError" class="error-message"></p>
                <br>
                <label for="">Email</label>
                <input class="form-control" type="text" name="email_provedor" id="email_provedor">
            
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
          <button type="submit" class="btn btn-primary">Guardar Cambios</button>
        </div>
    </form>  
    </div>
    </div>
  </div>



    <!-- Modal  EDITAR -->
    {% for p in prov %} 
    <div class="modal fade" id="editproModal-{{forloop.counter}}" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLabel">Editar Provedor</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form action="/editarprovedores/{{p.id_provedor}}" method="POST">
                    {% csrf_token %}
                    <label for="">ID</label>
                    <input class="form-control" type="text" name="id_provedor" value="{{p.id_provedor}}" id="id_provedor">
                    <br>
                    <label for="">Nombre</label>
                    <input value="{{p.nombre_provedor}}" class="form-control" type="text" name="nombre_provedor" id="nombre_provedor">
                    <br>
                    <label for="">Apellido</label>
                    <input value="{{p.apellido_provedor}}" class="form-control" type="text" name="apellido_provedor" id="apellido_provedor">
                    <br>
                    <label for="">Compañia</label>
                    <input value="{{p.compañia_provevdor}}" class="form-control" type="text" name="compañia_provevdor" id="">
                    <br>
                    <label for="">Telefono</label>
                    <input value="{{p.telefono_provedor}}" class="form-control" type="text" name="telefono_provedor" id="telefono_provedor">
                    <br>
                    <label for="">Email</label>
                    <input value="{{p.email_provedor}}" class="form-control" type="text" name="email_provedor" id="email_provedor">
                
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
              <button type="submit" class="btn btn-primary">Guardar Cambios</button>
            </div>
        </form>  
        </div>
        </div>
      </div>
      {% endfor %} 
    

<script>
    
$(document).ready(function() {
$('#mytable').DataTable({
"language": {
"url": "//cdn.datatables.net/plug-ins/1.10.15/i18n/Spanish.json"
}
});
});



$("#myform").validate({
    rules: {
        id_provedor: {
        noSpace:true,
        required: true,
        noSpaceafterletters:true
      },
      nombre_provedor: {
        noRepetidos:true,
        required: true, 

        lettersonly: true,
        noSpace:true,
      },
      apellido_provedor: {
        noRepetidos:true,
        noSpace:true,
        required: true,
        apellidocontrol: true,

      },
      compañia_provevdor: {
        noConsecutiveTriples:true,
        noSpace:true,
        required: true,

      },
      email_provedor: {
        noRepetidos:true,
        noSpace:true,
        required: true,
        emailcontrol: true,
      },
    
      telefono_provedor: {
      telefonoHonduras:true,  
      noSpace:true,
        required: true,
        minlength: 8,
        maxlength: 8
      },

    },
    
    messages: {

        nombre_provedor: {
        noRepetidos:"No Se permiten Letras Repetidas, Ni espacios repetidos",

   
        noSpace:"No se Permiten Espacios Aca",
      },
      apellido_provedor: {
        noRepetidos:"No Se permiten Letras Repetidas ,Ni espacios repetidos",


        noSpace:"No se Permiten Espacios Aca NO HAGA ESO",
      },
      compañia_provevdor: {
        noRepetidos:"No Se permiten Letras Repetidas , Ni espacios repetidos",


        noSpace:"No se Permiten Espacios Aca Ya se lo Dije",
      },
      email_provedor: {
        noRepetidos:"No Se permiten Letras Repetidas , Ni espacios repetidos",
        emailcontrol: "Por favor introduce un email válido Ejemplo: usuario@gmail.com sin espacios",
        noSpace:"No se Permiten Espacios Aca YA Pare",
      },

      telefono_provedor: {
        telefonoHonduras:"Por favor ingresa un número de teléfono válido de Honduras (ej: +504 8888-8888)",
        minlength: "Debes ingresar como mínimo 8 caracteres.",
        maxlength: "No puedes ingresar más de 8 caracteres.",
        noSpace:"No se Permiten Espacios Aca",
      
      },
      


    },





    submitHandler: function(form) {

      var telefono = $("#telefono_provedor").val();
var telefonoPattern = /^(504)?[ -]?(?:(\d)(?!\2{7})){8}$/;
if (!telefonoPattern.test(telefono)) {
  $("#telefonoError").text("El número de teléfono debe tener el formato 504######## y no puede tener todos los dígitos iguales");
  return false;
}


      $("#mensaje-confirmacion").show();
      form.submit();
    }
  });


  $('#confirm_password').on('input', function() {
    var password = $('#password').val();
    var confirmPassword = $(this).val();

    if (password === confirmPassword) {
      $('#password-message').text('Las contraseñas coinciden');
    } else {
      $('#password-message').text('Las contraseñas no coinciden');
    }
  });



// Regla personalizada para validar Que no hayan Espacios
  $.validator.addMethod("noSpace", function(value, element) {
  return value.trim().length !== 0; // Devuelve verdadero si no hay espacios en blanco alrededor de la entrada
}, "No se permiten espacios en blanco");


$.validator.addMethod("telefonoHonduras", function(value, element) {
  return this.optional(element) || /^(\+504)?[ -]?\d{4}[ -]?\d{4}$/.test(value);
}, "Por favor ingresa un número de teléfono válido de Honduras (ej: +504 8888-8888)");



$.validator.addMethod("lettersonly", function(value, element) {
    var regex = /^[A-Z][a-z]{2,}\s[A-Z][a-z]{3,}$/;
    var isValid = regex.test(value);
    if (!isValid) {
        $.validator.messages.lettersonly = "Este campo solo puede contener letras y debe comenzar con una letra mayúscula";
        if (value.trim().split(" ").length < 2) {
            $.validator.messages.lettersonly = "Debe introducir su Segundo Nombre después del espacio";
        } else if (!/^[A-Z][a-z]{2,}\s[A-Z][a-z]{3,}$/.test(value)) {
            $.validator.messages.lettersonly = "El Nombre y su Segundo Nombre debe comenzar con una letra mayúscula y tener al menos 3 o 4 letras";
        }
        return false;
    }
    return true;
}, "");

$.validator.addMethod("apellidocontrol", function(value, element) {
    var regex = /^[A-Z][a-z]{2,}\s[A-Z][a-z]{3,}$/;
    var isValid = regex.test(value);
    if (!isValid) {
        $.validator.messages.apellidocontrol = "Este campo solo puede contener letras y debe comenzar con una letra mayúscula";
        if (value.trim().split(" ").length < 2) {
            $.validator.messages.apellidocontrol = "Debe introducir su segundo Apellido después del espacio";
        } else if (!/^[A-Z][a-z]{2,}\s[A-Z][a-z]{3,}$/.test(value)) {
            $.validator.messages.apellidocontrol = "El Apellido y su Segundo Apellido debe comenzar con una letra mayúscula y tener al menos 3 o 4 letras";
        }
        return false;
    }
    return true;
}, "");


jQuery.validator.addMethod("noSpaceafterletters", function(value, element) { 
        return this.optional(element) || /^[^\s]+\s*[^\s]*$/.test(value);
    }, "No letras ni digitos despues de espacios por favor");
    




$.validator.addMethod("emailcontrol", function(value, element) {
  // Nueva validación de la regla de correo electrónico
  return this.optional(element) || /^[^\s@]+@[^\s@]+\.[^\s@]{2,}(?:\.[^\s@]{2,})?$/.test(value);
}, "Por favor introduce un email válido Ejemplo: usuario@gmail.com sin espacios");




$.validator.addMethod('noConsecutiveTriples', function(value, element) {
  // Expresión regular que busca 3 caracteres iguales consecutivos
  var regex = /([a-zA-Z0-9])\1\1/;
  
  return !regex.test(value);
}, 'No se permiten caracteres consecutivos triples.');


//regla para validar Los caracteres repetidos
$.validator.addMethod("noRepetidos", function(value, element) {
  return this.optional(element) || !/(.)\1+/.test(value);
}, "No se permiten caracteres repetidos en este campo Ni espacios Repetidos");






</script>

</body>
</html>